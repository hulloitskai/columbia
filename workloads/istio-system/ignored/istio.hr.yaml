---

apiVersion: flux.weave.works/v1beta1
kind: HelmRelease

metadata:
  name: istio
  namespace: istio-system
  annotations:
    flux.weave.works/automated: "false"
    flux.weave.works/ignored: "true"
  labels:
    app.kubernetes.io/name: istio

spec:
  releaseName: istio
  chart:
    repository: https://charts.stevenxie.me
    name: istio
    version: 0.1.0
  values:
    pilot:
      enabled: true
      sidecar: true
    gateways:
      enabled: false
      istio-ingressgateway:
        type: ClusterIP
    security:
      enabled: false
    sidecarInjectorWebhook:
      enabled: true
    galley:
      enabled: true
    mixer:
      policy:
        enabled: false
      telemetry:
        enabled: false
    prometheus:
      enabled: false

    # Common settings.
    global:
      proxy:
        # Sets the destination Statsd in envoy (the value of the
        # "--statsdUdpAddress" proxy argument would be <host>:<port>).
        # Disabled by default.
        # The istio-statsd-prom-bridge is deprecated and should not be used
        # moving forward.
        envoyStatsd:
          # If enabled is set to true, host and port must also be provided.
          # Istio no longer provides a statsd collector.
          enabled: false
          host: # example: statsd-svc.istio-system
          port: # example: 9125
      useMCP: false
